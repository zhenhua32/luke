<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="easyui.css">
    <link rel="stylesheet" href="icon.css">
    <!--<link rel="stylesheet" type="text/css" href="combobox.css">-->
    <script src="jquery.min.js"></script>
    <script src="jquery.easyui.min.js"></script>
</head>
<body>
<select id="importNation" class="easyui-combobox" name="importNation" style="width:133px;" data-options="panelHeight : 'auto'"></select>
<select id="importState" class="easyui-combobox " name="importState" style="width:133px;" data-options="panelHeight : 'auto'"></select>
<select id="importCity" class="easyui-combobox" name="importCity" style="width:133px;" data-options="panelHeight : 'auto',panelMaxHeight : '50px'"></select>
<script>
    var enquiryDetails={};
    enquiryDetails.importNation='156';
    enquiryDetails.importState='156,44';
    enquiryDetails.importCity='156,44,01';
    var myCascade = function(code) {
        if (code == '') {
            select = '#importNation'
        } else if (',' in code) {
            select = '#importState'
        } else if (code == '') {
            select = '#importCity'
        }

        $(select).combobox({

        })

    }
    //市级联
    var cityCascade =function(code) {
        $('#importCity').combobox({
            valueField:'code',
            textField:'shortNameZh',
            url:'http://114.55.95.15/api/area/list_area_by_code?code='+code+'&_system=iacon',
            editable:false,
            method:'get',
            headers: {
                'Cookie': 'cybertron.staff=JTdCaWQlM0ExJTdE; isTrial=bg==; JSESSIONID=1r5e7ynaclrudetjltp19nu0f',
                'Host': '114.55.95.15',
                'Origin': '114.55.95.15'
            },
            loadFilter:function (res) {
                return res.data;
            },
            onLoadSuccess:function (data) {
                if(code && code ==enquiryDetails.importState){
                    $(this).combobox('setValue',enquiryDetails.importCity);
                }else{
                    $(this).combobox('setValue', data.data[0].code);
                }
            }

        });
    }
    //省级联
    var stateCascade=function(code) {
        $('#importState').combobox({
            valueField:'code',
            textField:'shortNameZh',
            url:'http://114.55.95.15/api/area/list_area_by_code?code='+code+'&_system=iacon',
            editable:false,
            method:'get',
            headers: {
                'Cookie': 'cybertron.staff=JTdCaWQlM0ExJTdE; isTrial=bg==; JSESSIONID=1r5e7ynaclrudetjltp19nu0f',
                'Host': '114.55.95.15',
                'Origin': '114.55.95.15'
            },
            loadFilter:function (res) {
                return res.data;
            },
            onLoadSuccess:function (data) {
                if(code && code == enquiryDetails.importNation) {
                    $(this).combobox('setValue', enquiryDetails.importState);
                    cityCascade(enquiryDetails.importState);
                }else{
                    $(this).combobox('setValue', data.data[0].code);
                }
            },
            onChange:function () {
                cityCascade($(this).combobox('getValue'));
            }
        });
    }
    //州级联
    var nationCascade = function() {
        $('#importNation').combobox({
            valueField:'code',
            textField:'shortNameZh',
            url:'http://114.55.95.15/api/area/list_area_by_code'+'?_system=iacon',
            editable:false,
            method:'get',
            headers: {
                'Cookie': 'cybertron.staff=JTdCaWQlM0ExJTdE; isTrial=bg==; JSESSIONID=1r5e7ynaclrudetjltp19nu0f',
                'Host': '114.55.95.15',
                'Origin': '114.55.95.15'
            },
            loadFilter:function (res) {
                return res.data;
            },
            onLoadSuccess:function (data) {
                $(this).combobox('setValue',enquiryDetails.importNation);
                stateCascade(enquiryDetails.importNation);
            },
            onChange:function (code) {
                stateCascade($(this).combobox('getValue'));
            }
        });
    };
    nationCascade();
    // 州: http://114.55.95.15/api/area/list_area_by_code?_system=iacon
    //省: http://114.55.95.15/api/area/list_area_by_code?code=156&_system=iacon
    //城市: http://114.55.95.15/api/area/list_area_by_code?code=156,10
</script>
</body>
</html>